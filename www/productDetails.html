<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>Portal Auto Center</title>
    <link rel="stylesheet" type="text/css" href="assets/css/pac_framework.css">
    <link rel="stylesheet" type="text/css" href="assets/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="assets/css/productDetails.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
  </head>
  <body>

    <!-- Toast dialog -->
    <div class="toast"></div>

    <!-- Page's header -->
    <nav class="nav-header">
      <!-- Arrow back icon -->
      <a id="menu" href="home.html">
        <div class="menu">
          <i id="return-button" class="material-icons block black-txt">arrow_back</i>
        </div>
      </a>
      <!-- Header title -->
      <!-- <div class="header-title">
        <span class="block">Produto</span>
      </div> -->
    </nav>
    <!-- *********************** -->

    <!-- Blank space -->
    <div class="blank-space"></div>

    <!-- Main content -->
    <div class="main">

      <!-- Example: https://www.google.com.br/search?safe=strict&biw=1920&bih=949&tbm=isch&sa=1&ei=I60CW6fbJYfTwgSc-5igBg&q=scrolling+activity&oq=scrolling+activity&gs_l=img.3..0l3j0i24k1l7.17352.20473.0.21014.18.13.0.0.0.0.411.2046.2-1j4j1.6.0....0...1c.1.64.img..12.6.2045...0i67k1j0i5i30k1.0.BmnaEaqSGBo#imgrc=unZOunmVEyifcM: -->
      <!-- https://4.bp.blogspot.com/-FJJ1ID5F9pI/Vuu5HsKaS7I/AAAAAAAACYw/MeGXfeSJH3oVmPP8pvVjh1FsmLqmY-zhw/s1600/NYV2t.gif -->

        <!-- Product's image -->
        <div id="product-img" class="product-img">

          <!-- Product's name -->
          <div id="product-name" class="product-name uppercase">
            <span id="name" class="block white-txt"></span>
          </div>

          <!-- Add to shopping cart button -->
          <div id="cart-button" class="add-to-cart">
            <i class="material-icons white-txt">shopping_cart</i>
          </div>
        </div>

        <!-- Product's details -->
        <div id="product-details" class="product-details">

          <!-- Product's price -->
          <div class="row">
            <div class="icon-container">
              <i class="material-icons fs-35" title="Garantia">attach_money</i>
            </div>
            <div class="info-text">
              <span id="price" class="block"></span>
            </div>
          </div>

          <!-- Content divisor -->
          <div class="divisor"></div>

          <!-- Product's warranty -->
          <div class="row">
            <div class="icon-container">
              <i class="material-icons fs-30">build</i>
            </div>
            <div class="info-text">
              <span id="warranty" class="block"></span>
            </div>
          </div>

          <!-- Content divisor -->
          <div class="divisor"></div>

          <!-- Product's model -->
          <div class="row">
            <div class="icon-container">
              <i class="material-icons fs-35">playlist_add_check</i>
            </div>
            <div class="info-text">
              <span id="model" class="block"></span>
            </div>
          </div>

          <!-- Content divisor -->
          <div class="divisor"></div>

          <!-- Product's category -->
          <div class="row">
            <div class="icon-container">
              <i class="material-icons fs-35" title="Categoria">list</i>
            </div>
            <div class="info-text">
              <span id="category" class="block"></span>
            </div>
          </div>

          <!-- Content divisor -->
          <div class="divisor"></div>

          <!-- Product's manufacturer -->
          <div class="row">
            <div class="icon-container">
              <i class="material-icons fs-30" title="Fabricante">business</i>
            </div>
            <div class="info-text">
              <span id="manufacturer" class="block"></span>
            </div>
          </div>

          <!-- Content divisor -->
          <div class="divisor"></div>

          <!-- Long text container -->
          <div class="long-text-container">

            <!-- Product's description -->
            <div id="long-text-desc" class="long-text-row">
              <!-- Icon's column -->
              <div class="icon-column">
                <i class="material-icons fs-35" title="Descrição">description</i>
              </div>

              <!-- Text's column -->
              <div class="text-column">
                <span id="description" class="block"></span>
              </div>

            </div>

            <!-- Content divisor -->
            <div id="note-divisor" class="divisor"></div>

            <!-- Product's observation -->
            <div id="long-text-obs" class="long-text-row">
              <!-- Icon's column -->
              <div class="icon-column">
                <i class="material-icons fs-35" title="Observações">note</i>
              </div>

              <!-- Text's column -->
              <div class="text-column">
                <span id="observation" class="block"></span>
              </div>

            </div>

          </div>

        </div>

    </div>

    <!-- Navigation bar (header) -->
    <nav class="snackbar green-light uppercase">
      <a href="#">
        Comprar
      </a>
    </nav>
    <!-- *********************** -->

    <!-- Component -->
    <script src="js/component.js"></script>
    <!-- DAOs -->
    <script src="js/dao/ProductDAO.js"></script>
    <!-- Models -->
    <script src="js/model/Product.js"></script>
    <script src="js/model/Order.js"></script>
    <script src="js/model/ShoppingCart.js"></script>

    <script>

      // Listener to page's scroll 
      $(window).scroll(function(){
        
        // Get scrolls position (top) 
        var scrollPos = $(this).scrollTop();

        // Set style on elements
        if (scrollPos > 385) 
        {
          // Product's name bar
          $('#product-name').css(
            {
              position:'fixed',
              padding:'0px 15%',
              backgroundColor:'#2A2E37',
              transition:'0.5s',
              top:'0px',
              fontSize:'1.3rem'
            }
          );

          // Return button (arrow back)
          $('#return-button').css(
            {
              color:'#fff',
              transition:'2s'
            }
          );
          
          // Shopping cart button
          $('#cart-button').css({display:'none'});
        }
        else // Remove style on elements
        {
          // Reset product's name bar style
          $('#product-name').css(
            {
              position:'',
              backgroundColor:'',
              padding:'0px 25%',
              fontSize:'1.8rem'
            }
          );

          // Reset return button (arrow back) style
          $('#return-button').css(
            {
              color:'#000'
            }
          );

          // Reset shopping cart button style
          $('#cart-button').css({display:'flex'});
        }
      });

      // Get product's information and fill field with it 
      var product = new Product().getProductBasicInfoById(
        getVariable('id'),
        function(product)
        {
          console.log(product);
          /*
            Fil some fields with product's data
          */
          // Name
          $('#name').text(product.nome);

          // Image
          $('#product-img').css(
            {
              'backgroundImage':`url(${picturePath['product']+getPictureName('produto',product.imagem)})`,
              'backgroundAttachment': 'fixed',
              'backgroundRepeat':'no-repeat'
            }
          );

          // Price
          $('#price').text(product.preco);

          // Warranty
          $('#warranty').text(product.garantia);

          // Model
          $('#model').text(product.modelo);

          // Category
          $('#category').text(product.categoria);

          // Manufacturer
          $('#manufacturer').text(product.fabricante);

          // Description
          // Verify if data is blank
          product.descricao === '' || product.descricao == null ?  $('#long-text-desc').hide() : $('#description').text(product.descricao);

          // Observation
          // Verify if data is blank
          if(product.observacao === '' || product.observacao == null)
          {
            // Hide the observation field
            $('#long-text-obs').hide(); 
            // Hide the content divisor
            $('#note-divisor').hide();
          } 
          else 
          {
            // Fill observation field with data
            $('#observation').text(product.observacao);
          }  


          // Listener on shopping cart button
          $('#cart-button').click(function(){

            var client = JSON.parse(localStorage.getItem('client'));
            
            var order = new Order
            (
              product.id_produto, 
              client.id_cliente, 
              3
            );

            ShoppingCart.addOrderToCart(order);

            toast('Produto adicionado ao carrinho',4000);
          });       


        },
        function()
        {

        }
      );

    </script>

  </body>
</html>
